2025-09-01 20:43:01,913 - __main__ - INFO - ✅ Database connection established
2025-09-01 20:43:01,913 - __main__ - INFO - 🚀 Starting CowSwap Price Service
2025-09-01 20:43:01,913 - __main__ - INFO - 📊 Settings: poll_interval=10s, recency_blocks=40
2025-09-01 20:43:01,913 - __main__ - INFO - 🌐 CowSwap API supports mainnet (chain_id=1) only
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] Found 1 recent unprocessed mainnet takes (< 40 blocks old)
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] Processing 1 takes with 2 unique tokens
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] 🔍 Fetching prices for 2 tokens via quotes
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] ⏰ Using 30-second delays between requests to avoid rate limiting
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] 🚀 Processing token 1/2: 0x62B9..0Aa7
2025-09-01 20:43:01,940 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x62B9..0Aa7 (amount: 100000000000000000)
2025-09-01 20:43:05,361 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:05,362 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x62B9..0Aa7 (amount: 1000000000000000000)
2025-09-01 20:43:10,155 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:10,155 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x62B9..0Aa7 (amount: 1000000)
2025-09-01 20:43:10,302 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:10,303 - __main__ - INFO - [COWSWAP] ❌ No price for 0x62B9..0Aa7
2025-09-01 20:43:10,303 - __main__ - INFO - [COWSWAP] 💤 Waiting 30 seconds before next request (2/2)...
2025-09-01 20:43:40,307 - __main__ - INFO - [COWSWAP] 🚀 Processing token 2/2: 0xf939..1b4E
2025-09-01 20:43:40,308 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xf939..1b4E (amount: 100000000000000000)
2025-09-01 20:43:40,758 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:40,758 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xf939..1b4E (amount: 1000000000000000000)
2025-09-01 20:43:44,343 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:44,343 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xf939..1b4E (amount: 1000000)
2025-09-01 20:43:44,482 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 20:43:44,483 - __main__ - INFO - [COWSWAP] ❌ No price for 0xf939..1b4E
2025-09-01 20:43:44,483 - __main__ - INFO - [COWSWAP] 📊 Successfully got 0/2 prices
2025-09-01 20:43:44,483 - __main__ - INFO - [COWSWAP] ✅ Processed 1 takes: stored 0 prices
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] Found 2 recent unprocessed mainnet takes (< 40 blocks old)
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] Processing 2 takes with 3 unique tokens
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] 🔍 Fetching prices for 3 tokens via quotes
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] ⏰ Using 30-second delays between requests to avoid rate limiting
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] 🚀 Processing token 1/3: 0xD533..cd52
2025-09-01 22:19:12,591 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xD533..cd52 (amount: 100000000000000000)
2025-09-01 22:19:17,762 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:19:17,762 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xD533..cd52 (amount: 1000000000000000000)
2025-09-01 22:19:23,144 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:19:23,144 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xD533..cd52 (amount: 1000000)
2025-09-01 22:19:28,510 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:19:28,511 - __main__ - INFO - [COWSWAP] ❌ No price for 0xD533..cd52
2025-09-01 22:19:28,511 - __main__ - INFO - [COWSWAP] 💤 Waiting 30 seconds before next request (2/3)...
2025-09-01 22:19:58,516 - __main__ - INFO - [COWSWAP] 🚀 Processing token 2/3: 0x8b83..f710
2025-09-01 22:19:58,516 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x8b83..f710 (amount: 100000000000000000)
2025-09-01 22:20:03,657 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:03,657 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x8b83..f710 (amount: 1000000000000000000)
2025-09-01 22:20:08,802 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:08,802 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0x8b83..f710 (amount: 1000000)
2025-09-01 22:20:13,964 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:13,964 - __main__ - INFO - [COWSWAP] ❌ No price for 0x8b83..f710
2025-09-01 22:20:13,964 - __main__ - INFO - [COWSWAP] 💤 Waiting 30 seconds before next request (3/3)...
2025-09-01 22:20:43,969 - __main__ - INFO - [COWSWAP] 🚀 Processing token 3/3: 0xff17..8B3c
2025-09-01 22:20:43,969 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xff17..8B3c (amount: 100000000000000000)
2025-09-01 22:20:49,499 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:49,499 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xff17..8B3c (amount: 1000000000000000000)
2025-09-01 22:20:54,916 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:54,917 - __main__ - INFO - [COWSWAP] 📤 Requesting quote for 0xff17..8B3c (amount: 1000000)
2025-09-01 22:20:55,128 - __main__ - INFO - [COWSWAP] 📥 Response: 404
2025-09-01 22:20:55,128 - __main__ - INFO - [COWSWAP] ❌ No price for 0xff17..8B3c
2025-09-01 22:20:55,128 - __main__ - INFO - [COWSWAP] 📊 Successfully got 0/3 prices
2025-09-01 22:20:55,128 - __main__ - INFO - [COWSWAP] ✅ Processed 2 takes: stored 0 prices
